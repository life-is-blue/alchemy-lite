<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Firecrawl Lite - ç½‘é¡µæŠ“å–å·¥å…·</title>
  <link rel="stylesheet" href="/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/marked@11.0.0/marked.min.js" 
          integrity="sha384-4Tu0AVV0VM7dUwfPXGZDt6OI+2sNBSrQZe1Gmz87gzoio1n3IeHCMwRrfqSi4/Oh" 
          crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.8/dist/purify.min.js"
          integrity="sha384-vdScihEZCfbPnBQf+lc7LgXUdJVYyhC3yWHUW5C5P5GpHRqVnaM6HJELJxT6IqwM"
          crossorigin="anonymous"></script>
</head>
<body>
  <!-- SVG Icon Sprite -->
  <object data="/icons.svg" type="image/svg+xml" style="display: none;"></object>
  <!-- Hero Section -->
  <div class="hero">
    <div class="hero-content">
      <img src="/image.png" alt="Firecrawl Lite" class="hero-image">
      <h1>Firecrawl Lite</h1>
      <p class="hero-subtitle">å°†ä»»æ„ç½‘é¡µè½¬æ¢ä¸ºå¹²å‡€ã€ç»“æ„åŒ–çš„ Markdown æ ¼å¼</p>
    </div>
  </div>

  <!-- Main Content -->
  <div class="container">
    <div class="card">
      <form id="scrapeForm">
        <div class="form-group">
          <label for="url">ç½‘é¡µåœ°å€ï¼ˆæ”¯æŒå¤šè¡Œæ‰¹é‡è¾“å…¥ï¼‰</label>
          <textarea 
            id="url" 
            name="url" 
            rows="1"
            placeholder="https://example.com" 
            required
            autofocus
          ></textarea>
        </div>

        <div class="options">
          <div class="checkbox-wrapper">
            <input type="checkbox" id="renderJS" name="renderJS">
            <label for="renderJS">æ¸²æŸ“ JavaScriptï¼ˆè¾ƒæ…¢ï¼Œé€‚ç”¨äºå•é¡µåº”ç”¨ï¼‰</label>
          </div>
          <div class="checkbox-wrapper">
            <input type="checkbox" id="enableCrawl" name="enableCrawl">
            <label for="enableCrawl">çˆ¬å–ç›¸åŒç›®å½•çš„æ‰€æœ‰é¡µé¢</label>
          </div>
        </div>

        <!-- Crawl options (hidden by default) -->
        <div id="crawlOptions" class="crawl-options" style="display:none">
          <div class="crawl-hint">
            å°†çˆ¬å–è·¯å¾„å‰ç¼€ä¸º <code id="detectedPrefix">/</code> çš„æ‰€æœ‰é¡µé¢
          </div>
          
          <div class="inline-controls">
            <div class="form-group-inline">
              <label for="maxPages">æœ€å¤§é¡µæ•°</label>
              <input type="number" id="maxPages" name="maxPages" value="50" min="1" max="200" />
            </div>
            
            <div class="form-group-inline">
              <label for="displayMode">ç»“æœå±•ç¤º</label>
              <select id="displayMode" name="displayMode">
                <option value="merged">åˆå¹¶ä¸ºå•æ–‡ä»¶</option>
                <option value="list">åˆ†é¡µåˆ—è¡¨</option>
              </select>
            </div>
          </div>
        </div>

        <button type="submit" class="button-primary" id="submitBtn" aria-label="å¼€å§‹æŠ“å–ç½‘é¡µ">
          å¼€å§‹æŠ“å–
          <span class="loading-spinner" id="loading" style="display: none;" role="status" aria-label="æ­£åœ¨åŠ è½½">
            <svg class="icon"><use href="/icons.svg#icon-spinner"></use></svg>
          </span>
        </button>
      </form>

      <div class="error" id="error" role="alert" aria-live="assertive"></div>
    </div>

    <div class="result" id="result">
      <div class="card">
        <div class="result-header">
          <span class="result-label">Markdown è¾“å‡º</span>
          <div class="button-group">
            <button 
              type="button" 
              class="button-secondary" 
              id="copyBtn"
              aria-label="å¤åˆ¶ Markdown åˆ°å‰ªè´´æ¿"
              data-copied-text="å·²å¤åˆ¶"
              data-error-text="å¤åˆ¶å¤±è´¥">
              <svg class="icon icon-sm"><use href="/icons.svg#icon-copy"></use></svg>
              <span>å¤åˆ¶</span>
            </button>
            <button 
              type="button" 
              class="button-secondary" 
              id="downloadBtn"
              aria-label="ä¸‹è½½ Markdown æ–‡ä»¶"
              data-downloaded-text="å·²ä¸‹è½½">
              <svg class="icon icon-sm"><use href="/icons.svg#icon-download"></use></svg>
              <span>ä¸‹è½½</span>
            </button>
          </div>
        </div>
        <textarea id="markdown" readonly></textarea>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <div class="footer-content" id="footerContent">
      <a id="githubLink" href="https://github.com" target="_blank">GitHub</a> Â· 
      <a id="healthCheckLink" href="/api/health" target="_blank">æœåŠ¡çŠ¶æ€</a> Â· 
      <span id="tagline">ç®€çº¦è€Œä¸ç®€å•</span>
    </div>
  </div>

  <!-- Preview Mode (Safari-style Unified Reader) -->
  <div id="previewMode" class="preview-container" style="display: none;">
    <!-- Unified Toolbar -->
    <header class="preview-toolbar" role="banner">
      <button class="close-btn" aria-label="å…³é—­é¢„è§ˆ">Ã—</button>
      <h1 class="preview-title" id="pageTitle">åŠ è½½ä¸­...</h1>
      <nav class="toolbar-actions" aria-label="å†…å®¹æ“ä½œ">
        <button class="action-btn" id="purifyBtn" style="display: none;" aria-label="AIæçº¯å†…å®¹">
          âœ¨ æçº¯
        </button>
        <button class="action-btn" data-action="copy" aria-label="å¤åˆ¶å½“å‰é¡µ">
          ğŸ“‹ å¤åˆ¶
        </button>
        <button class="action-btn" data-action="export" aria-label="å¯¼å‡ºå½“å‰é¡µ">
          â¬‡ï¸ å¯¼å‡º
        </button>
        
        <!-- Pagination Controls (shown in batch mode) -->
        <div class="pagination" id="pagination" style="display: none;" role="navigation" aria-label="é¡µé¢å¯¼èˆª">
          <button class="page-btn" id="prevBtn" disabled aria-label="ä¸Šä¸€é¡µ">â€¹</button>
          <span class="page-indicator" id="pageIndicator" aria-live="off" aria-atomic="true">1 / 1</span>
          <button class="page-btn" id="nextBtn" disabled aria-label="ä¸‹ä¸€é¡µ">â€º</button>
        </div>
      </nav>
      <button class="done-btn" aria-label="å®Œæˆé˜…è¯»">å®Œæˆ</button>
    </header>
    
    <!-- Content Area (multi-page support) -->
    <div class="preview-content" id="previewContent">
      <!-- .page-wrapper elements will be dynamically generated -->
    </div>
    
    <!-- Progress Indicator (shown in batch mode) -->
    <div class="progress-indicator" 
         id="progressIndicator" 
         role="status" 
         aria-label="é˜…è¯»è¿›åº¦" 
         aria-live="off"
         style="display: none;">
      <!-- .progress-dot elements will be dynamically generated -->
    </div>
    
    <!-- Toast Container (preview mode only) -->
    <div class="preview-toast" id="previewToast" role="alert" aria-live="polite"></div>
  </div>

  <script src="/config.js"></script>
  <script>
    // APIåœ°å€é…ç½®ï¼ˆç”±Caddyåå‘ä»£ç†ç»Ÿä¸€å¤„ç†ï¼‰
    // æœ¬åœ°å¼€å‘: http://localhost:8000 â†’ Caddyåå‘ä»£ç†
    //   â”œâ”€ /api/* â†’ localhost:3000 (åç«¯)
    //   â””â”€ /* â†’ localhost:8080 (å‰ç«¯)
    // ç”Ÿäº§ç¯å¢ƒ: https://example.com â†’ Caddyåå‘ä»£ç†
    //   â”œâ”€ /api/* â†’ è‡ªæœ‰æœåŠ¡å™¨:3000
    //   â””â”€ /* â†’ Vercel (å‰ç«¯)
    // 
    // å‰ç«¯ä½¿ç”¨ç›¸å¯¹è·¯å¾„ '/api/scrape'ï¼Œåå‘ä»£ç†è‡ªåŠ¨è½¬å‘
    // æ— éœ€è®¾ç½® window.API_BASEï¼Œä½¿ç”¨app.jsé»˜è®¤çš„ '/api'
  </script>
  <script src="/app.js"></script>
  <script>
    // åˆå§‹åŒ–footeré“¾æ¥
    document.getElementById('githubLink').href = AppConfig.get('links.github');
    document.getElementById('healthCheckLink').href = AppConfig.get('links.healthCheck');
    document.getElementById('tagline').textContent = AppConfig.get('tagline', 'ç®€çº¦è€Œä¸ç®€å•');
  </script>
</body>
</html>
